{
  "task": "2.2_domain_adaptation_f4",
  "timestamp": "2025-11-11T20:55:28.379382",
  "target_flight": "F4",
  "baseline_loo_r2": -0.9776265583594399,
  "baseline_loo_mae_km": 0.14196900627492667,
  "domain_shift_description": "Flight F4 exhibits significantly lower mean CBH compared to other flights, causing catastrophic failure in leave-one-out validation. Few-shot adaptation uses a small number of F4 samples to adapt the model to the F4 domain.",
  "few_shot_experiments": {
    "5_samples": {
      "r2": -0.5280204735071277,
      "std_r2": 0.7650008960697567,
      "mae_km": 0.11231764582353825,
      "std_mae_km": 0.01858493141024095,
      "improvement_over_baseline": 0.44960608485231224
    },
    "10_samples": {
      "r2": -0.2195456664265653,
      "std_r2": 0.17654115165436257,
      "mae_km": 0.10595105113730019,
      "std_mae_km": 0.00577150187562163,
      "improvement_over_baseline": 0.7580808919328745
    },
    "20_samples": {
      "r2": -0.7077024259176614,
      "std_r2": 0.7046017358815921,
      "mae_km": 0.11359157517894017,
      "std_mae_km": 0.009927785959388726,
      "improvement_over_baseline": 0.2699241324417785
    }
  },
  "conclusion": "\u2713 Few-shot adaptation successfully mitigates F4 domain shift. With 20 samples, R\u00b2 improves from -0.9776 to -0.7077 (+0.2699), demonstrating effective domain adaptation. Even 5 samples provide meaningful improvement (+0.4496). Recommendation: Use 10-20 labeled F4 samples for production deployment to handle F4-like domains.",
  "baseline_metrics": {
    "r2": -0.9776265583594399,
    "mae_km": 0.14196900627492667,
    "rmse_km": 0.1886431667969104,
    "mae_m": 141.96900627492667,
    "rmse_m": 188.6431667969104,
    "n_train": 889,
    "n_test": 44
  },
  "detailed_results": {
    "5_samples": {
      "n_few_shot": 5,
      "n_trials": 10,
      "mean_r2": -0.5280204735071277,
      "std_r2": 0.7650008960697567,
      "mean_mae_km": 0.11231764582353825,
      "std_mae_km": 0.01858493141024095,
      "mean_rmse_km": 0.16089237390246897,
      "std_rmse_km": 0.019935128674660404,
      "trials": [
        {
          "trial": 0,
          "r2": -0.04609508177795818,
          "mae_km": 0.09790798894008915,
          "rmse_km": 0.14262722538227451,
          "n_train": 894,
          "n_test": 39,
          "few_shot_indices": [
            926,
            913,
            914,
            925,
            923
          ]
        },
        {
          "trial": 1,
          "r2": -0.1081646935134013,
          "mae_km": 0.09723338531568013,
          "rmse_km": 0.14617989537805665,
          "n_train": 894,
          "n_test": 39,
          "few_shot_indices": [
            895,
            920,
            903,
            915,
            928
          ]
        },
        {
          "trial": 2,
          "r2": -0.08909665823214863,
          "mae_km": 0.10376849715553832,
          "rmse_km": 0.1458830023136775,
          "n_train": 894,
          "n_test": 39,
          "few_shot_indices": [
            913,
            894,
            900,
            905,
            925
          ]
        },
        {
          "trial": 3,
          "r2": -0.176816776320196,
          "mae_km": 0.1010032047468283,
          "rmse_km": 0.1505843852181967,
          "n_train": 894,
          "n_test": 39,
          "few_shot_indices": [
            926,
            896,
            889,
            905,
            915
          ]
        },
        {
          "trial": 4,
          "r2": -0.5939052168738439,
          "mae_km": 0.12946517654298076,
          "rmse_km": 0.17336110347577435,
          "n_train": 894,
          "n_test": 39,
          "few_shot_indices": [
            892,
            909,
            895,
            893,
            902
          ]
        },
        {
          "trial": 5,
          "r2": -0.33429588784426434,
          "mae_km": 0.11082240569309466,
          "rmse_km": 0.1615894277480202,
          "n_train": 894,
          "n_test": 39,
          "few_shot_indices": [
            906,
            908,
            917,
            922,
            900
          ]
        },
        {
          "trial": 6,
          "r2": -0.48319449621788646,
          "mae_km": 0.10621299511423644,
          "rmse_km": 0.16380140194813153,
          "n_train": 894,
          "n_test": 39,
          "few_shot_indices": [
            919,
            892,
            922,
            898,
            924
          ]
        },
        {
          "trial": 7,
          "r2": -0.6460101430056846,
          "mae_km": 0.13514344971829853,
          "rmse_km": 0.1724844954964023,
          "n_train": 894,
          "n_test": 39,
          "few_shot_indices": [
            903,
            899,
            911,
            912,
            889
          ]
        },
        {
          "trial": 8,
          "r2": -0.07002510025845643,
          "mae_km": 0.09065232128598587,
          "rmse_km": 0.1421135034620306,
          "n_train": 894,
          "n_test": 39,
          "few_shot_indices": [
            890,
            923,
            924,
            929,
            897
          ]
        },
        {
          "trial": 9,
          "r2": -2.732600681027437,
          "mae_km": 0.15096703372265025,
          "rmse_km": 0.2102992986021256,
          "n_train": 894,
          "n_test": 39,
          "few_shot_indices": [
            893,
            918,
            930,
            904,
            889
          ]
        }
      ]
    },
    "10_samples": {
      "n_few_shot": 10,
      "n_trials": 10,
      "mean_r2": -0.2195456664265653,
      "std_r2": 0.17654115165436257,
      "mean_mae_km": 0.10595105113730019,
      "std_mae_km": 0.00577150187562163,
      "mean_rmse_km": 0.15363193226465408,
      "std_rmse_km": 0.006432578337181407,
      "trials": [
        {
          "trial": 0,
          "r2": -0.09394486710893823,
          "mae_km": 0.10743450341375603,
          "rmse_km": 0.15480009661179447,
          "n_train": 899,
          "n_test": 34,
          "few_shot_indices": [
            926,
            913,
            914,
            925,
            923,
            929,
            893,
            901,
            897,
            892
          ]
        },
        {
          "trial": 1,
          "r2": -0.07836363932639001,
          "mae_km": 0.09966483634952776,
          "rmse_km": 0.15189420832778433,
          "n_train": 899,
          "n_test": 34,
          "few_shot_indices": [
            895,
            920,
            903,
            915,
            928,
            902,
            917,
            894,
            896,
            908
          ]
        },
        {
          "trial": 2,
          "r2": -0.15543673374399414,
          "mae_km": 0.10296886159066129,
          "rmse_km": 0.156215565743931,
          "n_train": 899,
          "n_test": 34,
          "few_shot_indices": [
            913,
            894,
            900,
            905,
            925,
            901,
            906,
            920,
            928,
            926
          ]
        },
        {
          "trial": 3,
          "r2": -0.23040292576586086,
          "mae_km": 0.10318205615218945,
          "rmse_km": 0.15814403356393908,
          "n_train": 899,
          "n_test": 34,
          "few_shot_indices": [
            926,
            896,
            889,
            905,
            915,
            914,
            930,
            894,
            908,
            932
          ]
        },
        {
          "trial": 4,
          "r2": -0.22852603488658407,
          "mae_km": 0.11027857723904254,
          "rmse_km": 0.15541430951487178,
          "n_train": 899,
          "n_test": 34,
          "few_shot_indices": [
            892,
            909,
            895,
            893,
            902,
            913,
            899,
            898,
            932,
            896
          ]
        },
        {
          "trial": 5,
          "r2": -0.2453730617575347,
          "mae_km": 0.11183184465425669,
          "rmse_km": 0.16402419242059155,
          "n_train": 899,
          "n_test": 34,
          "few_shot_indices": [
            906,
            908,
            917,
            922,
            900,
            923,
            902,
            904,
            913,
            899
          ]
        },
        {
          "trial": 6,
          "r2": -0.23825890433250296,
          "mae_km": 0.09615207199348381,
          "rmse_km": 0.15590200738343843,
          "n_train": 899,
          "n_test": 34,
          "few_shot_indices": [
            919,
            892,
            922,
            898,
            924,
            931,
            914,
            930,
            900,
            928
          ]
        },
        {
          "trial": 7,
          "r2": -0.21171513254925034,
          "mae_km": 0.11662295810603548,
          "rmse_km": 0.15211866670630647,
          "n_train": 899,
          "n_test": 34,
          "few_shot_indices": [
            903,
            899,
            911,
            912,
            889,
            922,
            913,
            891,
            906,
            909
          ]
        },
        {
          "trial": 8,
          "r2": -0.01544030727030088,
          "mae_km": 0.103293179116472,
          "rmse_km": 0.13780216041631763,
          "n_train": 899,
          "n_test": 34,
          "few_shot_indices": [
            890,
            923,
            924,
            929,
            897,
            902,
            907,
            917,
            905,
            912
          ]
        },
        {
          "trial": 9,
          "r2": -0.697995057524297,
          "mae_km": 0.10808162275757698,
          "rmse_km": 0.15000408195756643,
          "n_train": 899,
          "n_test": 34,
          "few_shot_indices": [
            893,
            918,
            930,
            904,
            889,
            906,
            915,
            931,
            908,
            891
          ]
        }
      ]
    },
    "20_samples": {
      "n_few_shot": 20,
      "n_trials": 10,
      "mean_r2": -0.7077024259176614,
      "std_r2": 0.7046017358815921,
      "mean_mae_km": 0.11359157517894017,
      "std_mae_km": 0.009927785959388726,
      "mean_rmse_km": 0.15744156089296593,
      "std_rmse_km": 0.017352969145708216,
      "trials": [
        {
          "trial": 0,
          "r2": -0.2705768423911181,
          "mae_km": 0.1303510283539778,
          "rmse_km": 0.18743385434492277,
          "n_train": 909,
          "n_test": 24,
          "few_shot_indices": [
            926,
            913,
            914,
            925,
            923,
            929,
            893,
            901,
            897,
            892,
            895,
            916,
            920,
            908,
            906,
            902,
            930,
            904,
            898,
            905
          ]
        },
        {
          "trial": 1,
          "r2": -0.29681241354416255,
          "mae_km": 0.12240227207701737,
          "rmse_km": 0.16878787392207203,
          "n_train": 909,
          "n_test": 24,
          "few_shot_indices": [
            895,
            920,
            903,
            915,
            928,
            902,
            917,
            894,
            896,
            908,
            897,
            909,
            924,
            907,
            927,
            898,
            911,
            899,
            923,
            925
          ]
        },
        {
          "trial": 2,
          "r2": -0.19659759094276952,
          "mae_km": 0.0981483451168179,
          "rmse_km": 0.12326767356589233,
          "n_train": 909,
          "n_test": 24,
          "few_shot_indices": [
            913,
            894,
            900,
            905,
            925,
            901,
            906,
            920,
            928,
            926,
            919,
            907,
            918,
            897,
            891,
            904,
            898,
            915,
            899,
            889
          ]
        },
        {
          "trial": 3,
          "r2": -2.4435121628039855,
          "mae_km": 0.12031456675188619,
          "rmse_km": 0.17081681247320035,
          "n_train": 909,
          "n_test": 24,
          "few_shot_indices": [
            926,
            896,
            889,
            905,
            915,
            914,
            930,
            894,
            908,
            932,
            918,
            907,
            911,
            923,
            902,
            898,
            928,
            917,
            899,
            909
          ]
        },
        {
          "trial": 4,
          "r2": -0.14678338848569128,
          "mae_km": 0.11118701904637522,
          "rmse_km": 0.16684773137428738,
          "n_train": 909,
          "n_test": 24,
          "few_shot_indices": [
            892,
            909,
            895,
            893,
            902,
            913,
            899,
            898,
            932,
            896,
            889,
            910,
            903,
            917,
            890,
            901,
            906,
            922,
            930,
            928
          ]
        },
        {
          "trial": 5,
          "r2": -0.4177414241824331,
          "mae_km": 0.11068351511380257,
          "rmse_km": 0.14630679856038828,
          "n_train": 909,
          "n_test": 24,
          "few_shot_indices": [
            906,
            908,
            917,
            922,
            900,
            923,
            902,
            904,
            913,
            899,
            931,
            901,
            920,
            894,
            911,
            892,
            893,
            903,
            918,
            889
          ]
        },
        {
          "trial": 6,
          "r2": -0.1959878239616466,
          "mae_km": 0.09777043829303743,
          "rmse_km": 0.1637625019828523,
          "n_train": 909,
          "n_test": 24,
          "few_shot_indices": [
            919,
            892,
            922,
            898,
            924,
            931,
            914,
            930,
            900,
            928,
            921,
            894,
            890,
            901,
            908,
            913,
            902,
            909,
            912,
            899
          ]
        },
        {
          "trial": 7,
          "r2": -0.776890288273532,
          "mae_km": 0.10816792714762251,
          "rmse_km": 0.13980626496534496,
          "n_train": 909,
          "n_test": 24,
          "few_shot_indices": [
            903,
            899,
            911,
            912,
            889,
            922,
            913,
            891,
            906,
            909,
            923,
            908,
            900,
            918,
            905,
            919,
            902,
            896,
            928,
            910
          ]
        },
        {
          "trial": 8,
          "r2": -1.5160120755437823,
          "mae_km": 0.11736619780294964,
          "rmse_km": 0.15842101604279887,
          "n_train": 909,
          "n_test": 24,
          "few_shot_indices": [
            890,
            923,
            924,
            929,
            897,
            902,
            907,
            917,
            905,
            912,
            913,
            901,
            932,
            908,
            916,
            918,
            930,
            914,
            889,
            898
          ]
        },
        {
          "trial": 9,
          "r2": -0.8161102490474925,
          "mae_km": 0.11952444208591499,
          "rmse_km": 0.14896508169790001,
          "n_train": 909,
          "n_test": 24,
          "few_shot_indices": [
            893,
            918,
            930,
            904,
            889,
            906,
            915,
            931,
            908,
            891,
            927,
            911,
            913,
            912,
            903,
            901,
            892,
            900,
            907,
            929
          ]
        }
      ]
    }
  }
}