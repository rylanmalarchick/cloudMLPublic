{
  "model_name": "ViT-Tiny Baseline",
  "sprint_work_package": "WP-1: Pre-Trained Backbones",
  "script_path": "sow_outputs/wp5/wp5_vit_baseline.py",
  "baseline_to_beat": {
    "model": "Physical GBDT (Real ERA5)",
    "r2": 0.668,
    "mae_km": 0.137
  },
  "validation_protocol": {
    "name": "Stratified 5-Fold Cross-Validation",
    "n_folds": 5,
    "stratify_by": "CBH Target",
    "forbidden_protocol": "Leave-One-Flight-Out (LOO) CV",
    "justification": "LOO CV failed (R2=-3.13) on F4 due to extreme domain shift."
  },
  "aggregate_metrics": {
    "mean_r2": 0.5770965695381165,
    "std_r2": 0.018597243899775743,
    "mean_mae_km": 0.16552200317382812,
    "std_mae_km": 0.006258191235101088,
    "mean_rmse_km": 0.24134913379518358,
    "std_rmse_km": 0.00758251528470009
  },
  "per_fold_results": [
    {
      "fold_id": 0,
      "n_train": 596,
      "n_val": 150,
      "n_test": 187,
      "r2": 0.5445330142974854,
      "mae_km": 0.17133988440036774,
      "rmse_km": 0.2525006045910235,
      "best_epoch": 16,
      "train_loss": 0.0014895961042687607,
      "val_loss": 0.05245477501302957
    },
    {
      "fold_id": 1,
      "n_train": 596,
      "n_val": 150,
      "n_test": 187,
      "r2": 0.5912415981292725,
      "mae_km": 0.15705934166908264,
      "rmse_km": 0.23655697484789143,
      "best_epoch": 12,
      "train_loss": 0.0038174150938478607,
      "val_loss": 0.06580599217365185
    },
    {
      "fold_id": 2,
      "n_train": 596,
      "n_val": 150,
      "n_test": 187,
      "r2": 0.5985910296440125,
      "mae_km": 0.15995900332927704,
      "rmse_km": 0.23267907249103761,
      "best_epoch": 11,
      "train_loss": 0.005231762089533731,
      "val_loss": 0.07066941447556019
    },
    {
      "fold_id": 3,
      "n_train": 597,
      "n_val": 150,
      "n_test": 186,
      "r2": 0.574539303779602,
      "mae_km": 0.17321264743804932,
      "rmse_km": 0.24808630292021938,
      "best_epoch": 8,
      "train_loss": 0.0008968520000053104,
      "val_loss": 0.04384523412833611
    },
    {
      "fold_id": 4,
      "n_train": 597,
      "n_val": 150,
      "n_test": 186,
      "r2": 0.57657790184021,
      "mae_km": 0.1660391390323639,
      "rmse_km": 0.23692271412574598,
      "best_epoch": 29,
      "train_loss": 0.005946693396739041,
      "val_loss": 0.06813297470410665
    }
  ],
  "hardware_config": {
    "gpu": "NVIDIA GTX 1070 Ti",
    "vram": "8 GB",
    "vram_mitigation_used": "None (batch_size sufficient)"
  },
  "timestamp": "2025-11-09T18:46:46.228332",
  "architecture": {
    "backbone": "ViT-Tiny (WinKawaks/vit-tiny-patch16-224)",
    "input_channels": 1,
    "input_handling": "Grayscale duplicated 3x to RGB, resized 440x640 -> 224x224",
    "patch_size": "16x16",
    "num_patches": 196,
    "trainable_layers": "All layers (ViT is small enough)"
  },
  "training": {
    "optimizer": "AdamW",
    "learning_rate": 3e-05,
    "weight_decay": 0.0001,
    "loss_function": "MSELoss",
    "early_stopping_patience": 10,
    "batch_size": 10,
    "accumulation_steps": 1
  }
}