{
  "model_name": "Temporal ViT (Multi-Frame)",
  "sprint_work_package": "WP-2: Temporal Modeling",
  "script_path": "sow_outputs/wp5/wp5_temporal.py",
  "baseline_to_beat": {
    "model": "Physical GBDT (Real ERA5)",
    "r2": 0.668,
    "mae_km": 0.137
  },
  "validation_protocol": {
    "name": "Stratified 5-Fold Cross-Validation",
    "n_folds": 5,
    "stratify_by": "CBH Target",
    "forbidden_protocol": "Leave-One-Flight-Out (LOO) CV",
    "justification": "LOO CV failed (R2=-3.13) on F4 due to extreme domain shift."
  },
  "aggregate_metrics": {
    "mean_r2": 0.726846969127655,
    "std_r2": 0.05227344576696319,
    "mean_mae_km": 0.12630311101675035,
    "std_mae_km": 0.007926596356003988,
    "mean_rmse_km": 0.1931053355846426,
    "std_rmse_km": 0.020750163282386255
  },
  "per_fold_results": [
    {
      "fold_id": 0,
      "n_train": 596,
      "n_val": 150,
      "n_test": 187,
      "r2": 0.6829968690872192,
      "mae_km": 0.1306077539920807,
      "rmse_km": 0.2106520876459801,
      "best_epoch": 12,
      "train_loss": 0.01999283087324201,
      "val_loss": 0.029592856207225276
    },
    {
      "fold_id": 1,
      "n_train": 596,
      "n_val": 150,
      "n_test": 187,
      "r2": 0.7186878323554993,
      "mae_km": 0.12923473119735718,
      "rmse_km": 0.19624412553644935,
      "best_epoch": 12,
      "train_loss": 0.016559558524828304,
      "val_loss": 0.03704840310628673
    },
    {
      "fold_id": 2,
      "n_train": 596,
      "n_val": 150,
      "n_test": 187,
      "r2": 0.6771872043609619,
      "mae_km": 0.13019424676895142,
      "rmse_km": 0.20865996306427728,
      "best_epoch": 12,
      "train_loss": 0.021372452435406367,
      "val_loss": 0.03685786869793542
    },
    {
      "fold_id": 3,
      "n_train": 597,
      "n_val": 150,
      "n_test": 186,
      "r2": 0.7327438592910767,
      "mae_km": 0.13098587095737457,
      "rmse_km": 0.19662415668515262,
      "best_epoch": 10,
      "train_loss": 0.01948780859510104,
      "val_loss": 0.02756049013298348
    },
    {
      "fold_id": 4,
      "n_train": 597,
      "n_val": 150,
      "n_test": 186,
      "r2": 0.8226190805435181,
      "mae_km": 0.11049295216798782,
      "rmse_km": 0.15334634499135366,
      "best_epoch": 19,
      "train_loss": 0.018609724678487205,
      "val_loss": 0.02990970788921818
    }
  ],
  "hardware_config": {
    "gpu": "NVIDIA GTX 1070 Ti",
    "vram": "8 GB",
    "vram_mitigation_used": "gradient_accumulation_steps: 4, reduced batch_size: 4"
  },
  "timestamp": "2025-11-09T20:29:00.946147",
  "architecture": {
    "frame_encoder": "ViT-Tiny (WinKawaks/vit-tiny-patch16-224)",
    "temporal_frames": 5,
    "temporal_aggregation": "Multi-head Attention (4 heads)",
    "input_handling": "Sequence of frames, resized to 224x224",
    "edge_handling": "Clamp to flight boundaries (no cross-flight sequences)",
    "regression_head": "Linear(192->256), ReLU, Dropout(0.3), Linear(256->1)"
  },
  "training": {
    "optimizer": "AdamW",
    "learning_rate": 2e-05,
    "weight_decay": 0.0001,
    "loss_function": "MSELoss",
    "early_stopping_patience": 10,
    "batch_size": 4,
    "accumulation_steps": 4,
    "effective_batch_size": 16
  }
}