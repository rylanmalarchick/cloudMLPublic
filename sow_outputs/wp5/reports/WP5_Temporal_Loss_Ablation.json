{
  "model_name": "Temporal ViT with Consistency Loss (Ablation Study)",
  "sprint_work_package": "WP-2: Temporal Modeling (Task 2.2)",
  "script_path": "sow_outputs/wp5/wp5_temporal_consistency.py",
  "baseline_to_beat": {
    "model": "Physical GBDT (Real ERA5)",
    "r2": 0.668,
    "mae_km": 0.137
  },
  "validation_protocol": {
    "name": "Stratified 5-Fold Cross-Validation",
    "n_folds": 5,
    "stratify_by": "CBH Target",
    "forbidden_protocol": "Leave-One-Flight-Out (LOO) CV",
    "justification": "LOO CV failed (R2=-3.13) on F4 due to extreme domain shift."
  },
  "ablation_results": {
    "lambda_0.05": {
      "lambda_temporal": 0.05,
      "aggregate_metrics": {
        "mean_r2": 0.6999399304389954,
        "std_r2": 0.06472006323992521,
        "mean_mae_km": 0.1405242294073105,
        "std_mae_km": 0.0170481895111747,
        "mean_rmse_km": 0.20219615038755076,
        "std_rmse_km": 0.02275220209403914
      },
      "per_fold_results": [
        {
          "fold_id": 0,
          "r2": 0.6515953540802002,
          "mae_km": 0.1532270461320877,
          "rmse_km": 0.2208390956402775,
          "best_epoch": 13
        },
        {
          "fold_id": 1,
          "r2": 0.7406003475189209,
          "mae_km": 0.12844908237457275,
          "rmse_km": 0.18844608198775573,
          "best_epoch": 16
        },
        {
          "fold_id": 2,
          "r2": 0.6067193746566772,
          "mae_km": 0.167711079120636,
          "rmse_km": 0.23031121058213097,
          "best_epoch": 18
        },
        {
          "fold_id": 3,
          "r2": 0.7105675935745239,
          "mae_km": 0.1297859251499176,
          "rmse_km": 0.2046192940066135,
          "best_epoch": 11
        },
        {
          "fold_id": 4,
          "r2": 0.7902169823646545,
          "mae_km": 0.12344801425933838,
          "rmse_km": 0.1667650697209762,
          "best_epoch": 18
        }
      ]
    },
    "lambda_0.1": {
      "lambda_temporal": 0.1,
      "aggregate_metrics": {
        "mean_r2": 0.7282463669776916,
        "std_r2": 0.04445702454348551,
        "mean_mae_km": 0.1256965786218643,
        "std_mae_km": 0.00924287498883858,
        "mean_rmse_km": 0.19294685847197254,
        "std_rmse_km": 0.016615195401936317
      },
      "per_fold_results": [
        {
          "fold_id": 0,
          "r2": 0.6470178961753845,
          "mae_km": 0.12975254654884338,
          "rmse_km": 0.22228509519338377,
          "best_epoch": 13
        },
        {
          "fold_id": 1,
          "r2": 0.7822591066360474,
          "mae_km": 0.1136227399110794,
          "rmse_km": 0.1726523237084033,
          "best_epoch": 14
        },
        {
          "fold_id": 2,
          "r2": 0.731702446937561,
          "mae_km": 0.11798654496669769,
          "rmse_km": 0.19022699964509826,
          "best_epoch": 15
        },
        {
          "fold_id": 3,
          "r2": 0.7341058254241943,
          "mae_km": 0.12716533243656158,
          "rmse_km": 0.19612253061469834,
          "best_epoch": 12
        },
        {
          "fold_id": 4,
          "r2": 0.746146559715271,
          "mae_km": 0.13995572924613953,
          "rmse_km": 0.18344734319827907,
          "best_epoch": 18
        }
      ]
    },
    "lambda_0.2": {
      "lambda_temporal": 0.2,
      "aggregate_metrics": {
        "mean_r2": 0.7280673265457154,
        "std_r2": 0.0425253790249966,
        "mean_mae_km": 0.13054928332567214,
        "std_mae_km": 0.012570798737170423,
        "mean_rmse_km": 0.1929485481527466,
        "std_rmse_km": 0.015171040153946568
      },
      "per_fold_results": [
        {
          "fold_id": 0,
          "r2": 0.6602256298065186,
          "mae_km": 0.13008300960063934,
          "rmse_km": 0.2180867699401044,
          "best_epoch": 10
        },
        {
          "fold_id": 1,
          "r2": 0.784259557723999,
          "mae_km": 0.10935934633016586,
          "rmse_km": 0.17185736695784792,
          "best_epoch": 14
        },
        {
          "fold_id": 2,
          "r2": 0.7087432146072388,
          "mae_km": 0.13711674511432648,
          "rmse_km": 0.1981991594344146,
          "best_epoch": 18
        },
        {
          "fold_id": 3,
          "r2": 0.7581977844238281,
          "mae_km": 0.12850388884544373,
          "rmse_km": 0.1870265187913538,
          "best_epoch": 17
        },
        {
          "fold_id": 4,
          "r2": 0.7289104461669922,
          "mae_km": 0.14768342673778534,
          "rmse_km": 0.18957292564001216,
          "best_epoch": 14
        }
      ]
    }
  },
  "hardware_config": {
    "gpu": "NVIDIA GTX 1070 Ti",
    "vram": "8 GB",
    "vram_mitigation_used": "gradient_accumulation_steps: 4, batch_size: 4"
  },
  "architecture": {
    "frame_encoder": "ViT-Tiny (WinKawaks/vit-tiny-patch16-224)",
    "temporal_frames": 5,
    "temporal_aggregation": "Multi-head Attention (4 heads)",
    "loss_function": "L_total = L_mse(center) + \u03bb * L_temporal",
    "temporal_loss": "L_temporal = mean(|pred_t - pred_{t-1}|)",
    "lambda_values_tested": [
      0.05,
      0.1,
      0.2
    ]
  },
  "timestamp": "2025-11-10T01:13:11.841907"
}