{
  "model_name": "FiLM-ViT Fusion (Image + ERA5)",
  "sprint_work_package": "WP-3: Advanced Fusion",
  "script_path": "sow_outputs/wp5/wp5_film_fusion.py",
  "baseline_to_beat": {
    "model": "Physical GBDT (Real ERA5)",
    "r2": 0.668,
    "mae_km": 0.137
  },
  "validation_protocol": {
    "name": "Stratified 5-Fold Cross-Validation",
    "n_folds": 5,
    "stratify_by": "CBH Target",
    "forbidden_protocol": "Leave-One-Flight-Out (LOO) CV",
    "justification": "LOO CV failed (R2=-3.13) on F4 due to extreme domain shift."
  },
  "aggregate_metrics": {
    "mean_r2": 0.5423485159873962,
    "std_r2": 0.032992591282618965,
    "mean_mae_km": 0.1659697026014328,
    "std_mae_km": 0.005876726516830185,
    "mean_rmse_km": 0.25088615280735177,
    "std_rmse_km": 0.008634563563061437
  },
  "per_fold_results": [
    {
      "fold_id": 0,
      "n_train": 596,
      "n_val": 150,
      "n_test": 187,
      "r2": 0.5072026252746582,
      "mae_km": 0.1639365553855896,
      "rmse_km": 0.26264441184938675,
      "best_epoch": 18,
      "train_loss": 0.017694645871718723,
      "val_loss": 0.04605304164191087
    },
    {
      "fold_id": 1,
      "n_train": 596,
      "n_val": 150,
      "n_test": 187,
      "r2": 0.5892197489738464,
      "mae_km": 0.15844310820102692,
      "rmse_km": 0.23714128999050685,
      "best_epoch": 21,
      "train_loss": 0.013801935276327034,
      "val_loss": 0.06162393468742569
    },
    {
      "fold_id": 2,
      "n_train": 596,
      "n_val": 150,
      "n_test": 187,
      "r2": 0.5471148490905762,
      "mae_km": 0.1618151068687439,
      "rmse_km": 0.24714840344687586,
      "best_epoch": 24,
      "train_loss": 0.012894043935618053,
      "val_loss": 0.06354770275453726
    },
    {
      "fold_id": 3,
      "n_train": 597,
      "n_val": 150,
      "n_test": 186,
      "r2": 0.5645304918289185,
      "mae_km": 0.17228186130523682,
      "rmse_km": 0.250987382944983,
      "best_epoch": 20,
      "train_loss": 0.017683807589734594,
      "val_loss": 0.04119426909213265
    },
    {
      "fold_id": 4,
      "n_train": 597,
      "n_val": 150,
      "n_test": 186,
      "r2": 0.5036748647689819,
      "mae_km": 0.17337188124656677,
      "rmse_km": 0.2565092758050066,
      "best_epoch": 9,
      "train_loss": 0.015664508224775393,
      "val_loss": 0.06271301458279292
    }
  ],
  "hardware_config": {
    "gpu": "NVIDIA GTX 1070 Ti",
    "vram": "8 GB",
    "vram_mitigation_used": "None (batch_size sufficient)"
  },
  "timestamp": "2025-11-10T01:30:58.708953",
  "architecture": {
    "image_encoder": "ViT-Tiny (WinKawaks/vit-tiny-patch16-224)",
    "atmospheric_encoder": "MLP (ERA5_dim -> 64 -> 64)",
    "fusion_mechanism": "FiLM (Feature-wise Linear Modulation)",
    "film_operation": "gamma * image_features + beta (learned from ERA5)",
    "regression_head": "Linear(192->256), ReLU, Dropout(0.3), Linear(256->1)"
  },
  "training": {
    "optimizer": "AdamW",
    "learning_rate": 3e-05,
    "weight_decay": 0.0001,
    "loss_function": "MSELoss",
    "early_stopping_patience": 10,
    "batch_size": 10,
    "accumulation_steps": 1
  }
}